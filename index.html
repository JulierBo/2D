<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Pro Manager - V3</title>
    <style>
        :root { --primary: #1e293b; --accent: #3b82f6; --win: #9333ea; --danger: #ef4444; }
        * { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: #f1f5f9; margin: 0; padding: 0; display: flex; justify-content: center; }
        
        .app { width: 100%; max-width: 450px; background: white; min-height: 100vh; display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        
        /* Header & Names */
        header { background: var(--primary); color: white; padding: 20px; border-bottom-left-radius: 25px; border-bottom-right-radius: 25px; }
        .head-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .name-input-group { display: flex; gap: 8px; margin-bottom: 10px; }
        .name-input-group input { flex: 1; padding: 10px; border-radius: 8px; border: none; outline: none; }
        .name-input-group button { background: var(--accent); color: white; border: none; padding: 10px 15px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .name-tags { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px; max-height: 50px; overflow-y: auto; }
        .tag { background: #475569; padding: 4px 10px; border-radius: 20px; font-size: 11px; display: flex; align-items: center; gap: 6px; }
        .tag span { color: #f87171; cursor: pointer; font-weight: bold; font-size: 14px; }
        select { width: 100%; padding: 12px; border-radius: 10px; border: 2px solid var(--accent); font-weight: bold; appearance: none; background: white; }

        /* Win Area */
        .win-section { background: #f3e8ff; padding: 15px; display: flex; gap: 10px; align-items: center; border-bottom: 1px solid #ddd; }
        #winNum { width: 80px; padding: 10px; text-align: center; font-size: 24px; font-weight: bold; border: 2px solid var(--win); border-radius: 12px; color: var(--win); }
        .btn-check { flex: 1; background: var(--win); color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; }

        /* Records Table */
        .record-container { flex: 1; overflow-y: auto; padding: 10px; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: center; font-size: 12px; color: #64748b; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        td { padding: 12px 5px; text-align: center; border-bottom: 1px solid #f8fafc; font-weight: bold; }
        .td-num { color: var(--accent); font-size: 18px; }
        .td-name { font-size: 11px; color: #f97316; text-transform: uppercase; }
        .btn-del { color: #cbd5e1; border: none; background: none; font-size: 20px; cursor: pointer; }
        .btn-del:hover { color: var(--danger); }

        /* Bottom Info */
        .summary { padding: 15px; background: #f8fafc; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: flex-end; }
        .btn-clear { background: #fee2e2; color: var(--danger); border: 1px solid #fecaca; padding: 6px 12px; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer; }
        .total-box { text-align: right; }
        .total-box label { font-size: 10px; color: #94a3b8; font-weight: bold; }
        .total-box div { font-size: 28px; font-weight: 900; color: var(--danger); }

        /* Keypad */
        .keypad { background: #e2e8f0; padding: 15px; border-top-left-radius: 25px; border-top-right-radius: 25px; }
        .key-inputs { display: grid; grid-template-cols: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .key-inputs input { padding: 15px; text-align: center; font-size: 24px; font-weight: bold; border-radius: 15px; border: 3px solid #cbd5e1; outline: none; }
        #inNum { border-color: var(--accent); background: white; }
        #inAmt { border-color: #22c55e; }

        .keys { display: grid; grid-template-cols: repeat(4, 1fr); gap: 8px; }
        .k { background: white; border: none; padding: 18px 0; border-radius: 12px; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 3px 0 #cbd5e1; }
        .k:active { transform: translateY(2px); box-shadow: none; }
        .k-orange { background: #f97316; color: white; box-shadow: 0 3px 0 #ea580c; }
        .k-green { background: #16a34a; color: white; grid-row: span 2; box-shadow: 0 3px 0 #15803d; }
        .k-red { background: var(--danger); color: white; box-shadow: 0 3px 0 #b91c1c; }
        .k-dark { background: #334155; color: white; font-size: 12px; padding: 12px 0; box-shadow: 0 3px 0 #1e293b; }
        .sp-keys { display: grid; grid-template-cols: repeat(3, 1fr); gap: 8px; margin-top: 8px; }

        /* Full Screen Overlays */
        .overlay { position: fixed; inset: 0; background: white; z-index: 100; display: none; flex-direction: column; padding: 25px; }
        .active { display: flex !important; }
        .close-btn { font-size: 35px; text-align: right; cursor: pointer; color: #94a3b8; line-height: 1; }
        .win-display { background: var(--win); color: white; padding: 40px; border-radius: 25px; text-align: center; margin-bottom: 20px; }
        .scroll-area { flex: 1; overflow-y: auto; }
        .list-item { padding: 15px; border: 1px solid #f1f5f9; border-radius: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
    </style>
</head>
<body>

<div class="app">
    <header>
        <div class="head-top">
            <h2 style="margin:0; color:#38bdf8; font-size: 20px;">2D PRO MANAGER</h2>
            <button onclick="openPage('histPage')" style="background:#475569; border:none; color:white; padding:5px 10px; border-radius:5px; cursor:pointer; font-size:12px;">üìú ·Äô·Äæ·Äê·Ä∫·Äê·Äô·Ä∫·Ä∏</button>
        </div>
        <div class="name-input-group">
            <input type="text" id="nameInput" placeholder="·Äî·Ä¨·Äô·Ää·Ä∫·Ä°·Äû·ÄÖ·Ä∫...">
            <button onclick="addName()">·Äï·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äë·Ää·Ä∑·Ä∫</button>
        </div>
        <div id="tagBox" class="name-tags"></div>
        <select id="nameSel"></select>
    </header>

    <div class="win-section">
        <input type="number" id="winNum" placeholder="·Äï·Ä±·Ä´·ÄÄ·Ä∫">
        <button class="btn-check" onclick="checkWin()">·Äï·Ä±·Ä´·ÄÄ·Ä∫·ÄÇ·Äè·Äî·Ä∫·Ä∏·ÄÖ·ÄÖ·Ä∫·Äô·Ää·Ä∫</button>
    </div>

    <div class="record-container">
        <table>
            <thead><tr><th>·ÄÇ·Äè·Äî·Ä∫·Ä∏</th><th>·ÄÑ·ÄΩ·Ä±</th><th>·Ä°·Äô·Ää·Ä∫</th><th>-</th></tr></thead>
            <tbody id="mainList"></tbody>
        </table>
    </div>

    <div class="summary">
        <button class="btn-clear" onclick="clearRecords()">CLEAR ALL</button>
        <div class="total-box">
            <label>TOTAL AMOUNT</label>
            <div id="totalDisplay">0</div>
        </div>
    </div>

    <div class="keypad">
        <div class="key-inputs">
            <input type="number" id="inNum" placeholder="·ÄÇ·Äè·Äî·Ä∫·Ä∏" readonly>
            <input type="number" id="inAmt" placeholder="·ÄÑ·ÄΩ·Ä±">
        </div>
        <div class="keys">
            <button class="k" onclick="press('7')">7</button>
            <button class="k" onclick="press('8')">8</button>
            <button class="k" onclick="press('9')">9</button>
            <button class="k k-orange" onclick="run('R')">R</button>
            <button class="k" onclick="press('4')">4</button>
            <button class="k" onclick="press('5')">5</button>
            <button class="k" onclick="press('6')">6</button>
            <button class="k k-orange" onclick="run('·Äï·Ä´')">·Äï·Ä´</button>
            <button class="k" onclick="press('1')">1</button>
            <button class="k" onclick="press('2')">2</button>
            <button class="k" onclick="press('3')">3</button>
            <button class="k k-green" onclick="submit()">OK</button>
            <button class="k" onclick="press('0')">0</button>
            <button class="k" onclick="press('00')">00</button>
            <button class="k k-red" onclick="del()">DEL</button>
        </div>
        <div class="sp-keys">
            <button class="k k-dark" onclick="run('·Äë·Ä≠·Äï·Ä∫')">TOP</button>
            <button class="k k-dark" onclick="run('·Äî·Ä±·Ä¨·ÄÄ·Ä∫')">BACK</button>
            <button class="k k-dark" onclick="run('·Ä°·Äï·Ä∞·Ä∏')">PAIR</button>
        </div>
    </div>
</div>

<div id="winPage" class="overlay">
    <div class="close-btn" onclick="closePage('winPage')">&times;</div>
    <div id="winContent"></div>
    <button onclick="closePage('winPage')" style="width:100%; padding:18px; background:var(--accent); color:white; border:none; border-radius:15px; font-weight:bold; font-size:16px; margin-top:15px;">BACK TO APP</button>
</div>

<div id="histPage" class="overlay">
    <div class="close-btn" onclick="closePage('histPage')">&times;</div>
    <h2 style="text-align:center; margin-bottom:20px;">·Äë·ÄΩ·ÄÄ·Ä∫·ÄÇ·Äè·Äî·Ä∫·Ä∏·Äô·Äæ·Äê·Ä∫·Äê·Äô·Ä∫·Ä∏</h2>
    <div id="histContent" class="scroll-area"></div>
</div>

<script>
    let recs = JSON.parse(localStorage.getItem('P2D_RECS')) || [];
    let names =
